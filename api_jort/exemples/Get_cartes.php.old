<?php
/*
include("Util.php");

const pokemon_API_key = "ab509e37-e93b-411f-9542-0b265878ee1b";

function CollecterLesDonnees($nom){
	
	// On va chercher les données dans la base de données des cartes Pokemons:
	$header_pokemon = array('X-Api-Key: '.pokemon_API_key);
	$curl = curl_init();
	curl_setopt($curl,CURLOPT_CUSTOMREQUEST,"GET");
	curl_setopt($curl, CURLOPT_PROXY, unicaen_proxy);
	curl_setopt($curl, CURLOPT_URL, "https://api.pokemontcg.io/v2/cards?q=name:${nom}");
	curl_setopt($curl, CURLOPT_HTTPHEADER, $header_pokemon);
	curl_setopt($curl, CURLOPT_RETURNTRANSFER, True);
	$JSON = curl_exec($curl);
	$results = json_decode($JSON,True);
	
	// Puis on les renvoie simplifiées

	
	// On lance les insertions:
	$numero_d_ordre = 0;
	$liste_cartes =Array();
	foreach ($results['data'] as $carte){
		$item = Array();
		$item["Nom_de_la_carte"]= $carte["name"];
		$item["Nom_du_bloc"]= $carte["set"]["name"];
		$item["Nom_de_la_serie"]= $carte["set"]["series"];
		$item["Date_d_emission"]= $carte["set"]["releaseDate"];
		if (array_key_exists("artist",$carte)){
            $item["Artiste"]= $carte["artist"];
		} else{
		$item["Artiste"]="";
		};
		if (array_key_exists("rarity",$carte)){
		$item["Rarete"]= $carte["rarity"];
		} else {
            $item["Rarete"]= "";
		};
		if (array_key_exists("cardmarket",$carte)){
		$item["Prix_du_marche"]= $carte["cardmarket"]["prices"]["averageSellPrice"];
		$item["Tendance_du_prix"]= $carte["cardmarket"]["prices"]["trendPrice"];
		} else {
            $item["Prix_du_marche"]= "";
			$item["Tendance_du_prix"]="";
		};
        $item["Image URL"]= $carte["images"]["small"];
		$liste_cartes[$numero_d_ordre]=$item;
		$numero_d_ordre = $numero_d_ordre + 1;
	}
	return(json_encode($liste_cartes));
}

$nom = $_GET['nom'];
echo CollecterLesDonnees($nom);





